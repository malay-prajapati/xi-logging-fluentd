[SERVICE]
    HTTP_Server     On
    HTTP_Listen     0.0.0.0
    HTTP_PORT       2046
    Flush           5
    Daemon          on
    Log_Level       info
    Parsers_File    /home/nutanix/fluentbit/parsers.conf

[INPUT]
    Name     syslog
    Tag      xi.system
    Parser   syslog-rfc3164
    Listen   0.0.0.0
    Port     5140
    Mode     tcp

[FILTER]
    Name record_modifier
    Match xi.system*
    RECORD component system

[INPUT]
    Name tail
    Tag  xi.acropolis
    # Monitor the symlink files instead of the original files otherwise mem
    # usage and cpu usage for fluent-bit bloats up.
    Path /home/nutanix/data/logs/acropolis.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.acropolis_fatal
    Path /home/nutanix/data/logs/acropolis.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.acropolis*
    RECORD component acropolis

[INPUT]
    Name tail
    Tag  xi.arithmos
    Path /home/nutanix/data/logs/arithmos.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.arithmos_fatal
    Path /home/nutanix/data/logs/arithmos.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.arithmos*
    RECORD component arithmos

[INPUT]
    Name tail
    Tag  xi.curator
    Path /home/nutanix/data/logs/curator.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.curator_fatal
    Path /home/nutanix/data/logs/curator.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.curator_fatal
    Path /home/nutanix/data/logs/curator_cli.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.curator*
    RECORD component curator

[INPUT]
    Name tail
    Tag  xi.uhura
    Path /home/nutanix/data/logs/uhura.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.uhura_fatal
    Path /home/nutanix/data/logs/uhura.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.uhura*
    RECORD component uhura

[INPUT]
    Name tail
    Tag  xi.ergon
    Path /home/nutanix/data/logs/ergon.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.ergon_fatal
    Path /home/nutanix/data/logs/ergon.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.ergon*
    RECORD component ergon

[INPUT]
    Name tail
    Tag  xi.aplos
    Path /home/nutanix/data/logs/aplos.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.aplos_fatal
    Path /home/nutanix/data/logs/aplos.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.aplos_engine
    Path /home/nutanix/data/logs/aplos_engine.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.aplos_engine_fatal
    Path /home/nutanix/data/logs/aplos_engine.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.aplos*
    RECORD component aplos

[INPUT]
    Name tail
    Tag  xi.genesis
    Path /home/nutanix/data/logs/genesis.log
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.genesis
    RECORD component genesis

[INPUT]
    Name tail
    Tag  xi.health_server
    Path /home/nutanix/data/logs/health_server.log
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    # Buffer only 0.1M of logs to detect a multiline message correctly.
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.health_server
    RECORD component health_server

[INPUT]
    Name tail
    Tag  xi.insights_fatal
    Path /home/nutanix/data/logs/insights_server.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.insights
    Path /home/nutanix/data/logs/insights_server.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.insights
    Path /home/nutanix/data/logs/insights_receiver.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.insights_fatal
    Path /home/nutanix/data/logs/insights_receiver.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.insights
    Path /home/nutanix/data/logs/insights_uploader.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.insights_fatal
    Path /home/nutanix/data/logs/insights_uploader.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.insights_fatal
    Path /home/nutanix/data/logs/insights_monitor.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    # Send 0.1M of logs to CFS at any point. This field limits the amount of
    # data sent to CFS in one chunk. It also determines the memory usage for
    # fluent-bit process. This field should be tweaked accordingly if a lot
    # of components are added.
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.insights*
    RECORD component insights

[INPUT]
    Name tail
    Tag  xi.scavenger
    Path /home/nutanix/data/logs/scavenger.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.scavenger_fatal
    Path /home/nutanix/data/logs/scavenger.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.scavenger*
    RECORD component scavenger

[INPUT]
    Name tail
    Tag  xi.zookeeper_fatal
    Path /home/nutanix/data/logs/zookeeper_monitor.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.zookeeper
    Path /home/nutanix/data/logs/zookeeper.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline c_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.zookeeper*
    RECORD component zookeeper

[INPUT]
    Name tail
    Tag  xi.pithos
    Path /home/nutanix/data/logs/pithos.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.pithos_fatal
    Path /home/nutanix/data/logs/pithos.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.pithos
    RECORD component pithos

[INPUT]
    Name tail
    Tag  xi.stargate
    Path /home/nutanix/data/logs/stargate.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.stargate_fatal
    Path /home/nutanix/data/logs/stargate.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.stargate*
    RECORD component stargate

[INPUT]
    Name tail
    Tag  xi.cassandra
    Path /home/nutanix/data/logs/cassandra.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.cassandra_fatal
    Path /home/nutanix/data/logs/cassandra_monitor.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.cassandra_fatal
    Path /home/nutanix/data/logs/dynamic_ring_changer.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.cassandra*
    RECORD component cassandra

[INPUT]
    Name tail
    Tag  xi.cerebro_fatal
    Path /home/nutanix/data/logs/cerebro.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.cerebro
    Path /home/nutanix/data/logs/cerebro.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_out_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.cerebro_fatal
    Path /home/nutanix/data/logs/cerebro_cli.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.cerebro*
    RECORD component cerebro

[INPUT]
    Name tail
    Tag  xi.prism
    Path /home/nutanix/data/logs/prism.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[INPUT]
    Name tail
    Tag  xi.prism_fatal
    Path /home/nutanix/data/logs/prism_monitor.FATAL
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline cpp_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.prism*
    RECORD component prism

[INPUT]
    Name tail
    Tag  xi.prism_gateway
    Path /home/nutanix/data/logs/prism_gateway.log
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline prism_gateway_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.prism_gateway
    RECORD component prism_gateway

# Log files for which all logs are streamed.
[INPUT]
    Name tail
    Tag  xi.foundation
    Path /home/nutanix/data/logs/foundation/20*/debug.log
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline foundation_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.foundation*
    RECORD component foundation

[INPUT]
    Name tail
    Tag  xi.hades
    Path /home/nutanix/data/logs/hades.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.hades
    RECORD component hades

[INPUT]
    Name tail
    Tag  xi.genesis_out
    Path /home/nutanix/data/logs/genesis.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.genesis_out
    RECORD component genesis_out

[INPUT]
    Name tail
    Tag  xi.upgrade_finish
    Path /home/nutanix/data/logs/finish.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.upgrade_finish
    RECORD component upgrade_finish

[INPUT]
    Name tail
    Tag  xi.upgrade_install
    Path /home/nutanix/data/logs/install.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.upgrade_install
    RECORD component upgrade_install

[INPUT]
    Name tail
    Tag  xi.preupgrade
    Path /home/nutanix/data/logs/preupgrade.out
    Path_Key source_filename
    Exclude_Path *.gz
    Multiline On
    Multiline_Flush 5
    Parser_Firstline python_regex
    Buffer_Chunk_Size 4K
    Buffer_Max_Size 16K
    Skip_Long_Lines On
    Key message
    db  ${DB_FILE}
    Mem_Buf_Limit 32K
    Refresh_Interval 30

[FILTER]
    Name record_modifier
    Match xi.preupgrade
    RECORD component preupgrade

[FILTER]
    Name record_modifier
    Match xi.*
    Record xih_n pentest2
    Record xih_s cvm
    Record xih_cell cell-1
    Record xih_dc iad-1-ppd
    Record xih_az us-east-1a
    Record xih_cname NTNX-pentest-2-iad-1-ppd-1
    Record xih_cid 4d2fafbf-c223-4682-835a-18e072dca0ff
    Record hostname ${HOSTNAME}

[OUTPUT]
    Name          forward
    Match         *
    Host          abfb4518bbb0011e984e802c19fbe058-2098409646.us-west-2.elb.amazonaws.com
    Port          24224
